# This variable is not used by any other files and is
# therefore not required. It is used only for setting the
# EXECUTABLE variable below.
PROJECT_NAME = dispatcher

# BOARD is used by the XMOS RTOS platform .cmake file
BOARD ?= XCORE-AI-EXPLORER

# BUILD_DIR and OUTPUT_DIR are used by the multitile_build.mk file.
# If not specified they default to 'build' and 'bin' respectively.
BUILD_DIR  = build
OUTPUT_DIR = bin

# EXECUTABLE is used by the multitile_build.mk file
# and it must be specified, and set to the file name
# (including relative path) of the ultimate .xe file
# that contains all the merged tile binaries.
EXECUTABLE = $(OUTPUT_DIR)/$(PROJECT_NAME).xe

.PHONY: all clean distclean run

all: $(EXECUTABLE)

# MULTITILE_CLEANUP_CMDS is a variable generated by
# multitile_build.mk and may be included here in clean's
# recipe to perform cleanup of the files generated by
# multitile_build.mk.
clean:
	$(MULTITILE_CLEANUP_CMDS)
	rm -f $(EXECUTABLE)

distclean:
	rm -rf $(BUILD_DIR)
	rm -rf $(OUTPUT_DIR)

run: $(EXECUTABLE)
	xrun --xscope $(EXECUTABLE)

# Escape any spaces in the SDK path
ESCAPED_XCORE_SDK_PATH = $(subst $(null) ,\ ,$(XCORE_SDK_PATH))

# This multitile build support file creates the 
# recipe for EXECUTABLE
include $(ESCAPED_XCORE_SDK_PATH)/tools/cmake_utils/multitile_build.mk